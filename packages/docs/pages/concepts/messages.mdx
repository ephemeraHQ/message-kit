# Messages

## Receiving

When a message is send through XMTP to your agent, the `onMessage` function is triggered. It brings the message with all the content and the sender.

{/* prettier-ignore-start */}

```tsx [src/index.ts]
onMessage(async (context: Context) => {
  const {
    message: {
      content: { text, params, attachment, reply, reference, skill, previousMsg },
      sender,
    },
  } = context;

  if (typeId === "text") {
    // Do something with the text
  } else if (typeId === "skill") {
    // Do something with the skill
    const { address, domain } = params;
    // Use params
  } else if (typeId === "reply") {
    // Do something with the `reply`
    console.log(reply,previousMsg);
  } else if (typeId === "attachment") {
    // Do something with the attachment data url
    console.log(attachment);
  }
});
```

{/* prettier-ignore-end */}

**Properties**

- `id`: string // The id of the message
- `message`: all the content of the message depending on the type
  - `text`: string // The content of the message
  - `skill`: string, // The skill of the message
  - `params`: string[], // The parameters of the message
  - `attachment`: Attachment // The attachment of the message
  - `reply`: Reply // The reply of the message
  - `reference`: string // The reference of the message
  - `previousMsg`: Message // The previous message
- `sender`: User // The user object of the sender
- `sent`: Date // The timestamp of the message
- `typeId`: string // The type of the message (text, reply, attachment, skill)

## Sending

App messages are messages that are sent when you send a reply to a message and are highlighted differently by the apps.

```tsx
// Send a message
await context.send("Your message.");
// Reply to the last message
await context.reply("Your message.");
// Send a message to specific users
await context.sendTo("Your message.", ["address1", "address2"]);
// Await a response
const answer = await context.awaitResponse("Please answer with yes or no", [
  "yes",
  "no",
]);
console.log(`You answered: ${answer}`);
// Send an image (max 1MB)
await context.sendImage("path/to/image.png");
// Send a remote image (max 1MB)
await context.sendImage("https://picsum.photos/200/300");
```

## Included

Check our included plugins for sending dynamic content.

<CustomHomePage.TileGrid3>
  <CustomHomePage.Tile
    href="/plugins/framekit"
    title="FrameKit"
    description="Use FrameKit to send frames."
    icon="ðŸ–¼ï¸"
  />
</CustomHomePage.TileGrid3>
