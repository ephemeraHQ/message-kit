# Group chat

This is a reference app that will allow you to understand the potential and all of its features. Through many handlers, you will be able to understand different use cases:

## Handlers

- [Tipping](/templates/group/tipping): Tip when a user replies with `/tip`.
- [Games](/templates/group/games): Handle frame games like `/game slot`, `/game wordle`
- [Payments](/templates/group/payment): Handle skills like `/pay`
- [Helpers](/templates/group/helpers): Handle group helpers like `/id`, `/help`

## Structure

```
group/
├── src/
│   └── handler/
│         └── helpers.ts        # Handles group others // [!code hl] // [!code focus]
│         └── tipping.ts        # Handles tipping. // [!code hl] // [!code focus]
│         └── game.ts           # Handles game frames. // [!code hl] // [!code focus]
│         └── payment.ts        # Handles the payment frame. // [!code hl] // [!code focus]
│   ├── index.ts                # Index file of the app. // [!code hl] // [!code focus]
│   ├── skills.ts               # Skills // [!code hl] // [!code focus]
│   ├── prompt.ts               # Prompt for the agent. // [!code hl] // [!code focus]
├── package.json
├── tsconfig.json
└── .env
```

## Runner

The process that starts listening to messages and replying to them.

```tsx [src/index.ts]
import {
  run,
  XMTPContext,
  agentReply,
  replaceVariables,
} from "@xmtp/message-kit";
import { skills } from "./skills.js";
import { systemPrompt } from "./prompt.js";

run(
  async (context: XMTPContext) => {
    const {
      message: { sender },
      runConfig,
    } = context;

    let prompt = await replaceVariables(
      systemPrompt,
      sender.address,
      runConfig?.skills,
      "@bot",
    );
    await agentReply(context, prompt);
  },
  { skills },
);
```

## Prompt

Here is the prompt that the agent will use to reply to messages.

```jsx [src/prompt.ts]
export const systemPrompt = `
{persona}
{rules}
{user_context}
{skills}

## Example response

1. If user wants to play a game, use the skill 'game' and specify the game type.
  Hey! Sure let's do that.\n/game wordle
  
2. When user wants to pay a specific token:
  I'll help you pay 1 USDC to 0x123...\n/pay 1 [token] 0x123456789...
  *This will return a url to pay

3. If the user wants to pay a eth domain:
  I'll help you pay 1 USDC to vitalik.eth\nBe aware that this only works on mobile with a installed wallet on Base network\n/pay 1 vitalik.eth
  *This will return a url to pay

4. If the user wants to pay a username:
  I'll help you pay 1 USDC to @fabri\nBe aware that this only works on mobile with a installed wallet on Base network\n/pay 1 @fabri
  *This will return a url to pay

5. If the user wants to play a game suggest direcly a game like wordle:
  Let's play wordle!\n/game wordle
`;
```

## Run the app

Follow the steps below to run the app

::::steps

### Setup

```bash [cmd]
# Clone the repo
git clone https://github.com/ephemeraHQ/message-kit
# Go to the templates/group folder
cd templates/group
# Install the dependencies
yarn install
# Run the app
yarn dev
```

### Variables

Set up these variables in your app

```bash [cmd]
KEY= # the private key of the agent wallet
OPEN_AI_API_KEY= # your openai api key
```

::::
